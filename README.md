# 株価データ分析ツール

複数のテクニカル指標を用いて、日本の株式市場の銘柄を分析し、投資判断の参考となる総合スコアを算出するツールです。
FastAPIをバックエンドとし、Dockerコンテナ上での実行を前提としています。

## 主な機能

- **複数指標による多角的な分析:**
  指定されたティッカーリストに基づき、株価データを自動でダウンロードし、以下のテクニカル指標を計算します。
  - **RSI (相対力指数):** 相場の過熱感を測ります。
  - **25日移動平均線からの乖離率:** 短期的な価格の行き過ぎを判断します。
  - **MACD:** トレンドの方向性と転換点を探ります。
  - **DMI (方向性指数):** トレンド転換をより早期に捉えるための指標です (`+DI` と `-DI` のクロスを評価)。
  - **ADX (平均方向性指数):** 発生しているトレンドの強さを数値化し、シグナルの信頼性を測ります。

- **投資判断の総合スコアリング:**
  各指標の買いシグナルを点数化し、合計した「総合スコア」を算出します。スコアが高いほど、複数の買い材料が重なっていると判断でき、有望な銘柄を効率的に見つけ出すことができます。

- **APIによるオンデマンド実行:**
  FastAPIサーバーとして動作し、APIエンドポイント (`/analyze/run-sync`) を通じていつでも分析処理を実行できます。

- **詳細情報の自動付加:**
  分析結果に加え、企業の事業概要や公式サイトといった詳細情報を自動で取得し、出力に含めます。

## 必須ライブラリ

本プロジェクトの実行には、以下のライブラリが必要です。
`requirements.txt` にすべて記載されています。

- `fastapi`: APIサーバー構築用
- `uvicorn`: ASGIサーバー
- `pandas`: データ分析のコアライブラリ
- `yfinance`: 株価データ取得用
- `pandas-ta`: テクニカル指標計算用 (RSI, MACD, DMI, ADXなど)

## 実行方法 (Docker)

### 1. Dockerイメージのビルド

プロジェクトのルートディレクトリで以下のコマンドを実行し、Dockerイメージをビルドします。

```bash
docker build -t rsi-app .
```

### 2. Dockerコンテナの実行

ビルドしたイメージを使ってコンテナを起動します。`-v`オプションでローカルの`data`ディレクトリをマウントすることで、分析結果がローカルマシンに保存されます。

```bash
# Windows (Command Prompt / PowerShell)
docker run -d -p 8000:8000 -v "%cd%\data:/app/data" --name rsi-container rsi-app

# Linux / macOS
docker run -d -p 8000:8000 -v "$(pwd)/data:/app/data" --name rsi-container rsi-app
```

*開発中は、ソースコードの変更を即座に反映させるため、`-v "$(pwd)/src:/app/src"` (または `%cd%\src`) を追加すると便利です。*

### 3. 分析の実行と結果の確認

コンテナ起動後、Webブラウザで `http://127.0.0.1:8000/docs` にアクセスすると、APIドキュメント（Swagger UI）が表示されます。

1. `POST /analyze/run-sync` エンドポイントを開きます。
2. 「Try it out」ボタンをクリックします。
3. （任意）リクエストボディでフィルタ条件を変更できます。
4. 「Execute」ボタンを押すと、同期的に分析が実行されます。

処理が完了すると、ローカルの `data/results` ディレクトリに、分析結果がスコア順にソートされた `enriched_output_*.json` ファイルが作成されます。

### 4. コンテナの管理

- **ログの確認:** `docker logs -f rsi-container`
- **停止:** `docker stop rsi-container`
- **削除:** `docker rm rsi-container`

## 注意事項

本ツールが提供する情報は、あくまで投資判断の参考材料であり、特定の投資行動を推奨するものではありません。投資に関する最終的な決定は、ご自身の判断と責任で行ってください。
