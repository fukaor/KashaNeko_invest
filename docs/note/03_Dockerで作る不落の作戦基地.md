# 【第3話】AI軍団の兵站を確保せよ！Dockerで作る不落の作戦基地

AIと社畜の100日戦争、第3話。
作戦会議は終わり、勝利の設計図は手に入れた。

しかし、どれだけ優れた兵士（コード）も、どれだけ緻密な戦略（ロジック）も、活動の拠点となる**基地**がなければ、ただの絵に描いた餅だ。

今日は、我々のAI軍団が最高のパフォーマンスを発揮するための**作戦基地**を建設する。そのための現代の魔法、それが「**Docker**」だ。

## なぜDockerという名の"要塞"が必要なのか？

僕「PCを新しくしたら、なぜか動かなくなった…」
同僚「俺の環境だと、普通に動くけど？」

エンジニアなら誰もが経験し、絶望するこの会話。忌まわしき「**環境差異**」という名の悪夢だ。OSの違い、ライブラリのバージョンの些細な違い…それは、兵士たちの士気を下げ、時には部隊を壊滅させる恐ろしい伝染病である。

我々のAI軍団を、この伝染病から守り、いつでも、どこでも、100%の力で戦えるようにする。そのために、外部から隔離されたクリーンな兵舎、すなわち「コンテナ」という名の箱を用意する。Dockerは、その兵舎を魔法のように作り出し、管理してくれる最高の工兵なのだ。

## 基地の設計図 `docker-compose.yml` を初公開する

そして、複数の兵舎（バックエンド、フロントエンド）を連携させ、一つの巨大な基地として機能させるための設計図が、この`docker-compose.yml`だ。今日、この瞬間に、僕らのプロジェクトに産声を上げたファイルである。

```yaml
version: '3.8'

services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8000:8000"
    volumes:
      - ./src:/app/src
    depends_on:
      - db
    environment:
      - DATABASE_URL=postgresql://kashaneko:password@db:5432/kashaneko_db
    tty: true
    stdin_open: true

  db:
    image: postgres:15-alpine
    volumes:
      - postgres_data:/var/lib/postgresql/data/
    environment:
      - POSTGRES_USER=kashaneko
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=kashaneko_db
    ports:
      - "5432:5432"

volumes:
  postgres_data:
```

この設計図には、今のところ「データ戦略部隊(db)」と「バックエンド兵舎(backend)」しか記載されていない。

僕が戦況をリッチなUIで監視するための「**司令室（フロントエンド）**」は、今後の戦いの進捗に合わせて建設していく予定だ。まずは頭脳と心臓部を完璧に仕上げるのが最優先。その話は、また別の機会に。

解説しよう。

*   `services`: これが基地に建設される各施設（部隊の兵舎）のリストだ。
*   `db`: 我が軍のすべての情報を記録し、守る「**データ戦略部隊（PostgreSQL）**」。
    *   `image: postgres:15-alpine`: 軽量かつ強力なPostgreSQL兵士を配備。
    *   `volumes`: `postgres_data` という名の「**永久記憶領域**」。これにより、万が一基地に何かあっても、我々の貴重な戦闘記録（データ）は失われない。
    *   `environment`: データベースの名前やパスワードといった機密情報。
*   `backend`: 我が軍の頭脳、Python部隊が駐屯する「**バックエンド兵舎**」。
    *   `build`: `Dockerfile` という指示書を元に兵舎を建設する。
    *   `ports`: `8000`番ゲートを開放し、外部からの指令（HTTPリクエスト）を受け付けられるようにする。
    *   `volumes`: ホストPCの`src`フォルダと、兵舎内の`/app/src`を繋ぐ「**秘密のトンネル**」。
    *   `depends_on: - db`: 「バックエンド兵舎」は「データ戦略部隊」なしでは機能しない、という依存関係を定義。必ずDBが先に起動するようになる。
    *   `environment`: 「データ戦略部隊」の連絡先（`DATABASE_URL`）を兵士たちに伝える。

このたった1枚の設計図があれば、`docker-compose up --build`という呪文を唱えるだけで、誰でも、どこでも、僕と全く同じ作戦基地を瞬時に建設できる。そう、読者のあなたもだ。

## 基地はできた。兵士を配置せよ。

作戦基地は完成した。
これで、環境差異に怯えることなく、コードを書くことだけに集中できる。

次回、いよいよこのクリーンで安全な基地に、最初の兵士を配置する。
**AI軍団の心臓部、分析ロジックの第一行目を、この手で書き上げるのだ。**

100日戦争は、新たな局面へ。
社畜エンジニアの反撃の狼煙が、今、上がる。
